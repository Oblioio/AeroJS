/* AeroJS v0.0.1 - http://oblio.io - @oblioio - (c) 2015 Oblio */
define(["jquery","FLOCK/app/GLUploaders","FLOCK/utils/ArrayExecuter"],function(a){"use strict";function b(){var a=[{fn:i(c,this),vars:"vShader"},{fn:i(c,this),vars:"fShader"},{fn:i(d,this),vars:null},{fn:i(e,this),vars:null}];j.execute(a)}function c(b){console.log("loadShader: "+this[b].path),a.ajax({dataType:"text",url:this[b].path,success:i(function(a){this[b].text=a,j.stepComplete()},this)})}function d(){console.log("createProgram");var a=this.gl,b=a.createShader(a.FRAGMENT_SHADER);if(a.shaderSource(b,this.fShader.text),a.compileShader(b),h.call(this,a,"2d-fragment-shader",b)){this.fShader.obj=b;var c=a.createShader(a.VERTEX_SHADER);if(a.shaderSource(c,this.vShader.text),a.compileShader(c),h.call(this,a,"2d-vertex-shader",c)){this.vShader.obj=c;var d=a.createProgram();a.attachShader(d,c),a.attachShader(d,b),a.linkProgram(d),a.getProgramParameter(d,a.LINK_STATUS)||console.log("Unable to initialize the shader program."),a.useProgram(d),this.program=d,a.program=d,j.stepComplete()}}}function e(){var a,b,c,d,e=this.gl,f=this.settings.uniforms;this.uniforms=[],this.inputs={};for(var g in f){switch(a=f[g],b=e.getUniformLocation(this.program,g),c=a.val,a.type){case"f":case"1f":d=FLOCK.app.GLUploaders.uniform1f;break;case"2f":d=FLOCK.app.GLUploaders.uniform2f;break;case"3f":d=FLOCK.app.GLUploaders.uniform3f;break;case"3m":d=FLOCK.app.GLUploaders.uniformMatrix3fv;break;case"4f":d=FLOCK.app.GLUploaders.uniform4f;break;case"4m":d=FLOCK.app.GLUploaders.uniformMatrix4fv;break;case"t":d=FLOCK.app.GLUploaders.uniform1i;break;default:console.log("uniform type: "+a.type+" not yet setup"),d=!1}this.inputs[g]=c,this.uniforms.push({id:g,type:a.type,loc:b,fn:d})}j.stepComplete()}function f(){for(var a,b=this.gl,c=this.uniforms.length;c--;)a=this.uniforms[c],a.fn&&a.fn(b,a.loc,this.inputs[a.id])}function g(){var a=this.gl;a.useProgram(this.program),a.program=this.program,this.updateUniforms(),a.drawArrays(a.TRIANGLE_STRIP,0,4)}function h(a,b,c){var d=this.gl.getShaderParameter(c,this.gl.COMPILE_STATUS);return d||console.log("Error compiling "+b+": "+this.gl.getShaderInfoLog(c)),d}function i(a,b){return function(){return a.apply(b,arguments)}}var j=FLOCK.utils.ArrayExecuter,k=function(a,b){this.type="GLProgram",this.inRenderList=!1,this.scene=b,this.settings=a,this.gl=this.scene.gl,this.drawToCanvas=!1,this.clearBuffer="true"==String(a.clearBuffer).toLowerCase()?!0:!1,console.log("this.clearBuffer: "+this.clearBuffer),this.vShader={path:this.settings.vertexShader.replace("~/",this.scene.dirPath)},this.fShader={path:this.settings.fragmentShader.replace("~/",this.scene.dirPath)}};k.prototype.init=b,k.prototype.updateUniforms=f,k.prototype.render=g,FLOCK.app=FLOCK.app||{},FLOCK.app.GLProgram=k}),define(["jquery","FLOCK/app/GLUploaders","FLOCK/utils/ArrayExecuter"],function(a){"use strict";function b(a){this.onLoadComplete=a?a:null,this.imgURL||(console.log("loadTexture ERROR: no image url"),this.onLoadComplete(),this.onLoadComplete=null),console.log("loadTexture: "+this.imgURL),this.imgObj=new Image,this.imgObj.onload=d(c,this),this.imgObj.src=this.imgURL}function c(){var a=this.gl,b=this.texture;a.activeTexture(a["TEXTURE"+this.texUnit]),a.bindTexture(a.TEXTURE_2D,b),this.width=this.imgObj.width,this.height=this.imgObj.height,a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.imgObj),this.onLoadComplete&&(this.onLoadComplete(),this.onLoadComplete=null)}function d(a,b){return function(){return a.apply(b,arguments)}}var e=(FLOCK.utils.ArrayExecuter,function(a,b){var c=b.gl,d=c.createTexture();this.type="texture",this.inRenderList=!1,this.scene=b,this.settings=a,this.imgURL=a.imgURL?a.imgURL.replace("~/",this.scene.dirPath):null,this.texUnit=a.texUnit,console.log("GLTexture Init: "+this.texUnit),this.gl=c,this.texture=d,c.activeTexture(c["TEXTURE"+this.texUnit]),c.bindTexture(c.TEXTURE_2D,d),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,!0),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR)});e.prototype.loadTexture=b,FLOCK.app=FLOCK.app||{},FLOCK.app.GLTexture=e}),define(["jquery"],function(a){"use strict";var b=function(a,b){};b.prototype.uniform1f=function(a,b,c){a.uniform1f(b,c)},b.prototype.uniform2f=function(a,b,c){a.uniform2f(b,c[0],c[1])},b.prototype.uniform3f=function(a,b,c){a.uniform3f(b,c[0],c[1],c[2])},b.prototype.uniform4f=function(a,b,c){a.uniform4f(b,c[0],c[1],c[2],c[3])},b.prototype.uniform1i=function(a,b,c){a.uniform1i(b,c)},b.prototype.uniform2i=function(a,b,c){a.uniform2i(b,c)},b.prototype.uniform3i=function(a,b,c){a.uniform3i(b,c)},b.prototype.uniform4i=function(a,b,c){a.uniform3i(b,c)},b.prototype.uniformMatrix2fv=function(a,b,c){a.uniformMatrix2fv(b,a.FALSE,c)},b.prototype.uniformMatrix3fv=function(a,b,c){a.uniformMatrix3fv(b,a.FALSE,c)},b.prototype.uniformMatrix4fv=function(a,b,c){a.uniformMatrix4fv(b,a.FALSE,c)},FLOCK.app=FLOCK.app||{},FLOCK.app.GLUploaders=new b}),define(["jquery","FLOCK/utils/ArrayExecuter"],function(a){"use strict";function b(){var a=[];d.execute(a)}function c(a){var b,c=a.split("."),d=window[c[0]];for(b=1;b<c.length;b++)d=d[c[b]];return d}var d=FLOCK.utils.ArrayExecuter,e=function(a,b){this.program=c(a.js),this.type="JSProgram",this.inRenderList=!1,this.scene=b,this.settings=a,this.gl=this.scene.gl,this.drawToCanvas=!1,this.outputs=[]};e.prototype.init=b,FLOCK.app=FLOCK.app||{},FLOCK.app.JSProgram=e}),function(a,b){a.utils=a.utils||{},"function"==typeof define&&define.amd?define([],function(){return a.utils.ArrayExecuter=b()}):a.utils.ArrayExecuter=b()}(window.FLOCK=window.FLOCK||{},function(){var a=[],b={execute:function(b){b.reverse();for(var c=0;c<b.length;c++)b[c]&&a.unshift(b[c]);this.runStep("")},tackOn:function(b){for(var c=0;c<b.length;c++)a.push(b[c]);this.runStep("")},runFunctionInScope:function(a){var b=a[0],c=a[1];a.length>2?a[2]:null;a.length>2?b[c](a[2]):b[c]()},runStep:function(b){if(0!=a.length){var c=a.shift(),d=c.fn;c.scope=c.scope||this,c.vars=void 0!==c.vars?c.vars:[],("string"==typeof c.vars||"number"==typeof c.vars)&&(c.vars=[c.vars]),d.apply(c.scope,c.vars)}},stepComplete:function(b){var c=this;a.length>0&&window.requestAnimationFrame(c.runStep)},stepComplete_instant:function(b){a.length>0&&this.runStep()},clearArrayExecuter:function(){a=[]}};return b});